<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì™¸ê³„ í˜•ì§ˆ ì¡°í•© ì—°êµ¬: ë³€ì´ ì•„ë‹Œ ì¢…ì¡±</title>
    <!-- Tailwind CSS CDN ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'module-alpha': '#10B981', // Emerald Green (Î±)
                        'module-beta': '#F59E0B',  // Amber Yellow (Î²)
                        'module-gamma': '#3B82F6', // Blue (Î³)
                        'module-delta': '#EC4899', // Pink (Î´)
                    }
                }
            }
        }
    </script>
    <style>
        /* ê¸°ë³¸ í°íŠ¸ ì„¤ì • */
        body { font-family: 'Inter', sans-serif; }
        
        /* ë“œë˜ê·¸ ê°€ëŠ¥ ìš”ì†Œì˜ ì»¤ì„œ ìŠ¤íƒ€ì¼ */
        .module { cursor: grab; transition: transform 0.1s ease, opacity 0.3s ease; }
        .module:active { transform: scale(1.05); }

        /* ë“œë˜ê·¸ ì¤‘ì¸ ìš”ì†Œ ìŠ¤íƒ€ì¼ */
        .dragging { opacity: 0.5; }

        /* ë“œë¡­ ìŠ¬ë¡¯ ìŠ¤íƒ€ì¼ */
        .drop-slot {
            transition: background-color 0.2s ease;
            box-shadow: 0 0 0 2px #E5E7EB; 
        }
        
        /* ë“œë˜ê·¸ ì§„ì… ì‹œ í•˜ì´ë¼ì´íŠ¸ */
        .drop-slot.drag-over {
            background-color: #A78BFA; /* ë³´ë¼ìƒ‰ í•˜ì´ë¼ì´íŠ¸ */
            box-shadow: 0 0 0 3px #8B5CF6;
        }

        /* í˜•ì§ˆ í”„ë ˆì„ ë ˆì´ë¸” (ì™¼ìª½) ìŠ¤íƒ€ì¼ */
        .trait-frame-label {
            width: 120px; /* ë„ˆë¹„ë¥¼ ëŠ˜ë ¤ ê°€ë…ì„± í™•ë³´ */
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px 0 0 8px;
            font-weight: bold;
            color: white;
            background-color: #4B5563; /* í”„ë ˆì„ ìƒ‰ìƒ */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            font-size: 0.875rem; /* sm í°íŠ¸ í¬ê¸° */
        }

        /* ê²°ê³¼ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .result-creature-card {
            background: linear-gradient(135deg, #1f2937, #374151); /* ë‹¤í¬ ê·¸ë ˆì´ ê·¸ë¼ë°ì´ì…˜ */
            color: #D1D5DB;
        }
    </style>
</head>

<body class="bg-gray-900 min-h-screen p-4 md:p-8 text-white">

    <div id="app" class="max-w-6xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-extrabold text-blue-400 tracking-tight">ğŸŒŒ ìš°ì£¼ ì¢…ì¡± ì„¤ê³„ ì‹œë®¬ë ˆì´í„° ğŸ› ï¸</h1>
            <p class="text-gray-400 mt-2 text-lg">ì–´ë–¤ ì¡°í•©ì´ë“  ê³ ìœ í•œ ì¢…ì¡±ì…ë‹ˆë‹¤. ììœ ë¡­ê²Œ í˜•ì§ˆì„ ì¡°í•©í•´ ë³´ì„¸ìš”.</p>
        </header>

        <main class="flex flex-col md:flex-row gap-8">
            <!-- 1. ìœ ì „ì ëª¨ë“ˆ í’€ -->
            <section class="gene-pool p-6 bg-gray-800 rounded-xl shadow-2xl md:w-1/3 border border-blue-600">
                <h2 class="text-2xl font-semibold mb-4 text-blue-300 border-b border-blue-700 pb-2">ìœ ì „ì  ëª¨ë“ˆ í’€</h2>
                <div id="gene-pool-container" class="grid grid-cols-2 gap-4">
                    <div class="module p-3 text-center rounded-lg shadow-md select-none bg-module-alpha text-white font-bold text-lg" draggable="true" id="Module1" data-label="Î±">Î± ëª¨ë“ˆ (ì´ë™)</div>
                    <div class="module p-3 text-center rounded-lg shadow-md select-none bg-module-beta text-white font-bold text-lg" draggable="true" id="Module2" data-label="Î²">Î² ëª¨ë“ˆ (ê°ê°)</div>
                    <div class="module p-3 text-center rounded-lg shadow-md select-none bg-module-gamma text-white font-bold text-lg" draggable="true" id="Module3" data-label="Î³">Î³ ëª¨ë“ˆ (ë°©ì–´)</div>
                    <div class="module p-3 text-center rounded-lg shadow-md select-none bg-module-delta text-white font-bold text-lg" draggable="true" id="Module4" data-label="Î´">Î´ ëª¨ë“ˆ (ìƒì¡´)</div>
                </div>
            </section>

            <!-- 2. ì™¸ê³„ í˜•ì§ˆ ê°€ë‹¥ ì¡°ë¦½ ì˜ì—­ -->
            <section class="trait-assembly-area p-6 bg-gray-800 rounded-xl shadow-2xl md:w-2/3 border border-blue-600">
                <h2 class="text-2xl font-semibold mb-4 text-blue-300 border-b border-blue-700 pb-2">ì™¸ê³„ í˜•ì§ˆ ìŠ¬ë¡¯</h2>
                
                <div id="trait-strand" class="flex flex-col items-start p-4 border-2 border-blue-500 rounded-lg bg-gray-700 space-y-2">
                    <!-- Trait Slots will be generated here by JS -->
                </div>
                
                <div class="mt-6 flex justify-center">
                    <button id="check-btn" class="px-8 py-3 bg-purple-600 text-white font-bold rounded-xl shadow-lg hover:bg-purple-700 transition duration-300 transform hover:scale-105">
                        ğŸŒŸ ì™¸ê³„ ì¢…ì¡± ë°œí˜„ í™•ì¸
                    </button>
                </div>
            </section>
        </main>
        
        <!-- 3. ê²°ê³¼ ë° ìƒëª…ì²´ ë””ìŠ¤í”Œë ˆì´ -->
        <section class="mt-8 p-6 rounded-xl shadow-xl result-creature-card border border-purple-400">
            <h2 class="text-3xl font-bold mb-4 text-white">ê²°ê³¼: ë°œí˜„ëœ ìƒˆë¡œìš´ ì¢…ì¡±</h2>
            <div id="result-message" class="text-xl font-medium text-yellow-300 mb-4">
                ëª¨ë“  í˜•ì§ˆ ìŠ¬ë¡¯ì— ëª¨ë“ˆì„ ì¡°í•©í•˜ê³  [ì™¸ê³„ ì¢…ì¡± ë°œí˜„ í™•ì¸] ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.
            </div>
            <div id="creature-display" class="bg-gray-900 p-4 rounded-lg text-center min-h-[100px] flex flex-col justify-center items-center border border-gray-700">
                <span class="text-6xl" id="creature-emoji">â“</span>
                <p class="text-2xl font-bold mt-2 text-purple-300" id="creature-name">ë¯¸í™•ì¸ ìš°ì£¼ ìƒëª…ì²´</p>
                <div id="creature-trait" class="mt-3 text-left w-full max-w-lg mx-auto p-2 bg-gray-800 rounded-lg">
                    <p class="text-sm text-gray-400">ì¡°í•©ì´ ì™„ë£Œë˜ë©´ ë°œí˜„ëœ ì™¸ê³„ í˜•ì§ˆ ëª©ë¡ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p>
                </div>
            </div>
        </section>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const traitStrand = document.getElementById('trait-strand');
            const checkBtn = document.getElementById('check-btn');
            const resultMessage = document.getElementById('result-message');
            const creatureEmoji = document.getElementById('creature-emoji');
            const creatureName = document.getElementById('creature-name');
            const creatureTrait = document.getElementById('creature-trait');

            // --- ê²Œì„ ì„¤ì • (ì™¸ê³„ì¸ í˜•ì§ˆ ëª¨ë“ˆ í…œí”Œë¦¿) ---
            const TEMPLATE_SEQUENCE = [
                { 
                    traitName: 'ì´ë™ ë°©ì‹', 
                    outcomes: {
                        'Module1': 'ê±°ëŒ€í•œ ë¹„ë§‰ ë‚ ê°œ', 
                        'Module2': 'ë‹¤ìˆ˜ì˜ ë¯¸ì„¸ ë‹¤ë¦¬', 
                        'Module3': 'ê°•ë ¥í•œ ì§€ë©´ ë„ì•½ ê·¼ìœ¡', 
                        'Module4': 'ìê¸° ë¶€ìƒ ë°œíŒ' 
                    }
                },
                { 
                    traitName: 'ê°ê° ê¸°ê´€', 
                    outcomes: {
                        'Module1': 'ê³ ì£¼íŒŒ ì†Œë¦¬ ê°ì§€ ì•ˆí…Œë‚˜', 
                        'Module2': '360ë„ ì‹œì•¼ë¥¼ ê°€ì§„ ë‘ ìŒì˜ ëˆˆ (4ê°œ)', 
                        'Module3': 'ìŠ¬ë¦¿í˜• ì²­ê° ê¸°ê´€', 
                        'Module4': 'ì „ìê¸°íŒŒ ê°ì§€ ì„¼ì„œ' 
                    }
                },
                { 
                    traitName: 'ë°©ì–´ ì²´ê³„',     
                    outcomes: {
                        'Module1': 'ê¸¸ê³  ë‚ ì¹´ë¡œìš´ ê³µê²©í˜• ë°œí†±', 
                        'Module2': 'ë‘êº¼ìš´ ê°‘ê° ë³´í˜¸ë§‰', 
                        'Module3': 'ì‹ ê²½ ë…ì†Œ ë¶„ë¹„ í”¼ë¶€', 
                        'Module4': 'ê´‘í•™ ìœ„ì¥ë§‰' 
                    }
                },
                { 
                    traitName: 'í‘œí”¼ êµ¬ì¡°', 
                    outcomes: {
                        'Module1': 'ë¶ˆíƒ€ëŠ” ë“¯í•œ ë¶‰ì€ìƒ‰ ì„¬ëª¨', 
                        'Module2': 'ì€í•˜ìˆ˜ë¥¼ ë‹´ì€ ë³´ë¼ìƒ‰ í”¼ë¶€', 
                        'Module3': 'íˆ¬ëª…í•œ ìœ ë¦¬ í”¼ë¶€', 
                        'Module4': 'ì£¼ë³€ í™˜ê²½ì— ë§ì¶˜ ë³€ìƒ‰ ë¹„ëŠ˜' 
                    }
                },
                { 
                    traitName: 'ìƒì²´ ì—°ë£Œ', 
                    outcomes: {
                        'Module1': 'ë‹¨ì•ˆ (Cyclops) ë° ì—´ ê°ì§€', 
                        'Module2': 'íƒœì–‘ ì—ë„ˆì§€ í¡ìˆ˜íŒ', 
                        'Module3': 'ë§¤ìš° í° í (ê³ ë°€ë„ í–‰ì„± ì í•©)', 
                        'Module4': 'ë©”íƒ„ í¡ìˆ˜ ì•„ê°€ë¯¸' 
                    }
                },
                { 
                    traitName: 'ì§€ëŠ¥ êµ¬ì¡°',     
                    outcomes: {
                        'Module1': 'ë¶„ì‚°ëœ ì‹ ê²½ë§ (êµ°ì²´ ì§€ëŠ¥)', 
                        'Module2': 'ê´‘ë²”ìœ„í•œ ê¸°ì–µë ¥ì„ ê°€ì§„ ë‘ë‡Œ', 
                        'Module3': 'ì§ë ¬ ì²˜ë¦¬í˜• ë‘ë‡Œ (ê³ ì† ì—°ì‚°)', 
                        'Module4': 'ë‹¨ì¼ ì§‘ì¤‘í˜• ë‘ë‡Œ (ê°•í•œ ì˜ì§€)' 
                    }
                },
            ];

            // ëª¨ë“ˆ IDë¥¼ ë ˆì´ë¸”ì— ë§¤í•‘
            const MODULE_LABELS = {
                'Module1': 'Î±',
                'Module2': 'Î²',
                'Module3': 'Î³',
                'Module4': 'Î´',
            };
            
            // ëª¨ë“ˆ IDë¥¼ ìƒ‰ìƒ í´ë˜ìŠ¤ì— ë§¤í•‘
            const MODULE_COLORS = {
                'Module1': 'bg-module-alpha',
                'Module2': 'bg-module-beta',
                'Module3': 'bg-module-gamma',
                'Module4': 'bg-module-delta',
            };


            // --- ì´ˆê¸° í˜•ì§ˆ ê°€ë‹¥ ë Œë”ë§ ---
            function renderTraitStrand() {
                traitStrand.innerHTML = '';
                TEMPLATE_SEQUENCE.forEach((item, index) => {
                    const pairDiv = document.createElement('div');
                    pairDiv.className = 'trait-pair-item w-full flex items-center justify-start space-x-4';
                    pairDiv.dataset.index = index;

                    // 1. í˜•ì§ˆ í”„ë ˆì„ ë ˆì´ë¸” (ì™¼ìª½)
                    const frameLabel = document.createElement('div');
                    frameLabel.className = `trait-frame-label`;
                    frameLabel.textContent = item.traitName;
                    pairDiv.appendChild(frameLabel);

                    // 2. ë“œë¡­ ìŠ¬ë¡¯ (ì˜¤ë¥¸ìª½, ì‚¬ìš©ìê°€ ì±„ìš¸ ê³µê°„)
                    const dropSlot = document.createElement('div');
                    dropSlot.className = 'drop-slot w-64 p-2 h-10 rounded-r-lg rounded-l-lg bg-gray-600 flex justify-center items-center text-gray-300 font-medium';
                    dropSlot.textContent = `ëª¨ë“ˆ ë“œë¡­ ê³µê°„`;
                    dropSlot.id = `slot-${index}`;
                    
                    pairDiv.appendChild(dropSlot);
                    traitStrand.appendChild(pairDiv);
                });
                setupDropHandlers();
                resetResults();
            }

            // --- ë“œë˜ê·¸ í•¸ë“¤ëŸ¬ ì„¤ì • ---
            function setupDragHandlers() {
                const modules = document.querySelectorAll('.module');
                modules.forEach(mod => {
                    mod.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('moduleId', e.target.id);
                        e.dataTransfer.setData('moduleLabel', e.target.dataset.label);
                        e.dataTransfer.setData('moduleColor', MODULE_COLORS[e.target.id]);
                        e.target.classList.add('dragging');
                    });
                    mod.addEventListener('dragend', (e) => {
                        e.target.classList.remove('dragging');
                    });
                });
            }

            // --- ë“œë¡­ í•¸ë“¤ëŸ¬ ì„¤ì • ---
            function setupDropHandlers() {
                const dropSlots = document.querySelectorAll('.drop-slot');
                dropSlots.forEach(slot => {
                    slot.addEventListener('dragenter', (e) => {
                        e.preventDefault();
                        if (slot.children.length === 0) { slot.classList.add('drag-over'); }
                    });

                    slot.addEventListener('dragover', (e) => { e.preventDefault(); });

                    slot.addEventListener('dragleave', (e) => { slot.classList.remove('drag-over'); });

                    slot.addEventListener('drop', (e) => {
                        e.preventDefault();
                        slot.classList.remove('drag-over');

                        if (slot.children.length > 0) {
                            slot.children[0].remove();
                        }
                        
                        const moduleId = e.dataTransfer.getData('moduleId');
                        const moduleLabel = e.dataTransfer.getData('moduleLabel');
                        const moduleColor = e.dataTransfer.getData('moduleColor');
                        
                        // ë³µì œëœ ë“œë¡­ ìš”ì†Œ ìƒì„±
                        const droppedModule = document.createElement('div');
                        droppedModule.id = moduleId; // ëª¨ë“ˆ ID ìœ ì§€
                        droppedModule.textContent = `${moduleLabel} ëª¨ë“ˆ`;
                        droppedModule.className = `w-full h-full flex items-center justify-center text-base font-bold text-white rounded-lg ${moduleColor}`;
                        
                        slot.textContent = '';
                        slot.appendChild(droppedModule);

                        showMessage('âœ… ìœ ì „ ëª¨ë“ˆ ê²°í•© ì™„ë£Œ. ë‹¤ë¥¸ í˜•ì§ˆë„ ì¡°í•©í•˜ì„¸ìš”.', 'blue');
                        resetResults(false);
                    });
                });
            }
            
            // --- ê²°ê³¼ ì´ˆê¸°í™” ---
            function resetResults(clearAll = true) {
                if (clearAll) {
                    creatureEmoji.textContent = 'â“';
                    creatureName.textContent = 'ë¯¸í™•ì¸ ìš°ì£¼ ìƒëª…ì²´';
                    creatureTrait.innerHTML = '<p class="text-sm text-gray-400">ì¡°í•©ì´ ì™„ë£Œë˜ë©´ ë°œí˜„ëœ ì™¸ê³„ í˜•ì§ˆ ëª©ë¡ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p>';
                    // ìŠ¬ë¡¯ ì´ˆê¸°í™”
                    document.querySelectorAll('.drop-slot').forEach(slot => {
                        slot.innerHTML = '';
                        slot.textContent = 'ëª¨ë“ˆ ë“œë¡­ ê³µê°„';
                        slot.classList.remove('bg-gray-700');
                    });
                }
                resultMessage.textContent = 'ëª¨ë“  í˜•ì§ˆ ìŠ¬ë¡¯ì— ëª¨ë“ˆì„ ì¡°í•©í•˜ê³  [ì™¸ê³„ ì¢…ì¡± ë°œí˜„ í™•ì¸] ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.';
                resultMessage.className = 'text-xl font-medium mb-4 text-yellow-300';
            }

            // --- ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜ (alert ëŒ€ì‹  ì‚¬ìš©) ---
            function showMessage(text, color) {
                resultMessage.textContent = text;
                resultMessage.className = 'text-xl font-medium mb-4';
                resultMessage.classList.add(`text-${color}-500`);
            }
            
            /**
             * ëª¨ë“ˆ ì‚¬ìš© íšŸìˆ˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì™¸ê³„ ì¢…ì¡±ì˜ ì´ë¦„ì„ ê²°ì •í•©ë‹ˆë‹¤.
             * ëŒì—°ë³€ì´/ì‹¤íŒ¨ ëŒ€ì‹  ì¡°í•©ì˜ íŠ¹ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ì¤‘ë¦½ì ì¸ ì´ë¦„ì„ ë¶€ì—¬í•©ë‹ˆë‹¤.
             */
            function determineSpeciesName(counts) {
                const totalModules = Object.values(counts).reduce((a, b) => a + b, 0);
                if (totalModules !== TEMPLATE_SEQUENCE.length) return { name: 'ë¯¸ì™„ì„± í”„ë¡œí† íƒ€ì…', emoji: 'âš™ï¸' };

                // 1. ëª¨ë“ˆë³„ ì‚¬ìš© íšŸìˆ˜ë¥¼ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
                const sortedCounts = Object.entries(counts)
                    .filter(([id, count]) => count > 0)
                    .sort(([, a], [, b]) => b - a);

                const countMap = sortedCounts.map(([id, count]) => ({
                    module: MODULE_LABELS[id],
                    count: count,
                    id: id
                }));
                
                const maxCount = countMap.length > 0 ? countMap[0].count : 0;
                
                let name = '';
                let emoji = '';

                // A. ë‹¨ì¼ ëª¨ë“ˆ ìš°ì„± (4ê°œ ì´ìƒ)
                if (maxCount >= 4) {
                    const dominantModule = countMap[0].module;
                    name = `${dominantModule} ìš°ì„±: ì€í•˜ê³„ ì§€ë°°ì ì¢…ì¡±`;
                    emoji = 'ğŸ‘‘';
                }
                // B. ì´ì¤‘ ëª¨ë“ˆ ìš°ì„± (3:3 ë˜ëŠ” 4:2)
                else if (maxCount >= 3 && countMap.length >= 2 && countMap[1].count >= 2) {
                    const primary = countMap[0].module;
                    const secondary = countMap[1].module;
                    name = `${primary}-${secondary} ì´ì¤‘: ê· í˜• ì¡íŒ ì •ë³µì ì¢…ì¡±`;
                    emoji = 'âš”ï¸';
                }
                // C. ê· í˜• ì¡íŒ í•˜ì´ë¸Œë¦¬ë“œ (3ê°œ ë˜ëŠ” 4ê°œì˜ ëª¨ë“ˆì„ ê³¨ê³ ë£¨ ì‚¬ìš©)
                else if (countMap.length === 4) {
                    name = 'ì¿¼ë“œ í•˜ì´ë¸Œë¦¬ë“œ: ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ì ì‘ ì¢…ì¡±';
                    emoji = 'ğŸ§ª';
                }
                // D. í¬ê·€í•˜ê³  ê·¹ë‹¨ì ì¸ ì¡°í•© (2ê°œ ëª¨ë“ˆë§Œ ì‚¬ìš© ë“±)
                else {
                    name = 'ë¯¸ë¶„ë¥˜ ì¢…ì¡±: ì‹¬ìš°ì£¼ íƒì‚¬ ì¢…ì¡±';
                    emoji = 'ğŸ›¸';
                }
                
                return { name, emoji };
            }

            // --- ì¡°í•© í™•ì¸ ë¡œì§ ---
            checkBtn.addEventListener('click', () => {
                const dropSlots = document.querySelectorAll('.drop-slot');
                const moduleCounts = { 'Module1': 0, 'Module2': 0, 'Module3': 0, 'Module4': 0 };
                let incomplete = false;
                
                const traits = []; // ë°œí˜„ëœ í˜•ì§ˆ ëª©ë¡

                dropSlots.forEach(slot => {
                    const droppedModuleElement = slot.children[0];
                    if (!droppedModuleElement) {
                        incomplete = true;
                        return;
                    }

                    const index = parseInt(slot.id.split('-')[1]);
                    const geneInfo = TEMPLATE_SEQUENCE[index];
                    const droppedModuleId = droppedModuleElement.id;
                    
                    // ëª¨ë“ˆ ì‚¬ìš© íšŸìˆ˜ ê¸°ë¡
                    moduleCounts[droppedModuleId]++;

                    // ê²°ê³¼ í˜•ì§ˆ ê°€ì ¸ì˜¤ê¸°: ë“œë¡­ëœ ëª¨ë“ˆ IDì— ë”°ë¼ í˜•ì§ˆì´ ê²°ì •ë¨
                    const resultantTraitValue = geneInfo.outcomes[droppedModuleId] || 'ì•Œ ìˆ˜ ì—†ëŠ” í˜•ì§ˆ';

                    // ìµœì¢… íŠ¹ì„± ì¡°í•© (ì¤‘ë¦½ì  í‘œì‹œ)
                    traits.push(`
                        <div class="flex justify-between items-start py-1 border-b border-gray-700 last:border-b-0">
                            <span class="text-purple-300">${geneInfo.traitName}:</span>
                            <div class="text-right">
                                <span class="text-white">${resultantTraitValue}</span><br>
                                <span class="text-xs text-gray-400">(${MODULE_LABELS[droppedModuleId]} ëª¨ë“ˆ ë°œí˜„)</span>
                            </div>
                        </div>
                    `);
                });

                if (incomplete) {
                    showMessage('âš ï¸ ëª¨ë“  í˜•ì§ˆ ìŠ¬ë¡¯ì— ëª¨ë“ˆì„ ë“œë¡­í•´ì•¼ ë°œí˜„ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'orange');
                    return;
                }
                
                // ê²°ê³¼ì— ë”°ë¥¸ ìƒëª…ì²´ ìƒì„±
                creatureTrait.innerHTML = traits.join('');
                
                // ìƒˆë¡œìš´ ì¢…ì¡± ì´ë¦„ ê²°ì •
                const { name, emoji } = determineSpeciesName(moduleCounts);
                
                creatureEmoji.textContent = emoji;
                creatureName.textContent = name;
                showMessage(`âœ… ì¢…ì¡± ë°œí˜„ ì™„ë£Œ: [${name}]ì´ íƒ„ìƒí–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ì¡°í•©ì„ ì‹œë„í•´ ë³´ì„¸ìš”!`, 'green');
            });
            
            // --- ì´ˆê¸° ì‹¤í–‰ ---
            renderTraitStrand();
            setupDragHandlers();
        });
    </script>
</body>
</html>